<script type="text/ng-template" id="promethee/components/column">
  <div ng-controller="ColumnController">
    <div class="col col-md-{{component.attributes.size}} col-md-offset-{{component.attributes.offset}}">
      <div dnd-draggable="component" dnd-moved="remove()" dnd-type="component.type" class="promethee-editor__component promethee-editor__component--column">
        <div class="promethee-editor__toolbar">
          Column
          <%= render 'promethee/partials/toolbar_buttons' %>
        </div>
        <div ng-show="editing" class="promethee-editor__wrapper">
          <div class="form-group">
            <label class="label-control">Size</label>
            <input ng-model="component.attributes.size" class="form-control" type="number"/>
          </div>
          <div class="form-group">
            <label class="label-control">Offset</label>
            <input ng-model="component.attributes.offset" class="form-control" type="number"/>
          </div>
        </div>
        <div class="promethee-editor__components" dnd-list="component.children" dnd-allowed-types="allowedTypes">
          <ng-include src="'promethee/components/index'"></ng-include>
        </div>
        <span type="button" class="btn btn-default btn-block" ng-click="addComponentTo(component.children)" style="margin: 0 6px 6px 6px;width: auto">Add component</span>
      </div>
    </div>
  </div>
</script>

<script>
  promethee.controller('ColumnController', ['$scope', 'definitions', function($scope, definitions) {

    $scope.allowedTypes = definitions.map(function(definition) {
      return definition.data.type;
    });

    $scope.remove = function() {
      this.components.splice(this.components.indexOf(this.component), 1);
    };
    
  }]);
</script>
